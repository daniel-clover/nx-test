"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.rollupInitSchematic = exports.rollupInitGenerator = void 0;
const tslib_1 = require("tslib");
const devkit_1 = require("@nx/devkit");
const versions_1 = require("@nx/js/src/utils/versions");
const versions_2 = require("../../utils/versions");
function rollupInitGenerator(tree, schema) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        let task;
        if (schema.compiler === 'swc') {
            task = (0, devkit_1.addDependenciesToPackageJson)(tree, {}, {
                '@nx/rollup': versions_2.nxVersion,
                '@swc/helpers': versions_1.swcHelpersVersion,
                '@swc/core': versions_1.swcCoreVersion,
                'swc-loader': versions_2.swcLoaderVersion,
            });
        }
        else {
            task = (0, devkit_1.addDependenciesToPackageJson)(tree, {}, {
                '@nx/rollup': versions_2.nxVersion,
                tslib: versions_2.tsLibVersion,
            });
        }
        if (!schema.skipFormat) {
            yield (0, devkit_1.formatFiles)(tree);
        }
        return task;
    });
}
exports.rollupInitGenerator = rollupInitGenerator;
exports.default = rollupInitGenerator;
exports.rollupInitSchematic = (0, devkit_1.convertNxGenerator)(rollupInitGenerator);
